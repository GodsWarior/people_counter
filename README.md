# People Counter

Система подсчета людей на видео с использованием YOLO и компьютерного зрения.

## Описание

Проект реализует систему подсчета людей, входящих и выходящих из определенных зон на видео. Использует YOLOv8 для детекции объектов и алгоритм трекинга для отслеживания людей между кадрами.

## Возможности

- ✅ Детекция людей с помощью YOLOv8
- ✅ Трекинг объектов между кадрами
- ✅ Подсчет входящих и выходящих людей
- ✅ Поддержка CUDA для ускорения обработки
- ✅ Визуализация результатов в реальном времени
- ✅ Модульная архитектура кода

## Требования

- Python 3.8+
- PyTorch (с поддержкой CUDA, если доступна GPU)
- OpenCV
- Ultralytics YOLO
- cvzone
- numpy

## Установка

1. Клонируйте репозиторий:
```bash
git clone https://github.com/yourusername/people_counter.git
cd people_counter
```

2. Установите зависимости:
```bash
pip install torch torchvision opencv-python ultralytics cvzone numpy
```

3. Скачайте модель YOLOv8:
   - Модель `yolov8s.pt` должна быть в корне проекта
   - Модель автоматически скачается при первом запуске, если её нет

## Использование

1. Поместите видео файл в папку `video/` и укажите путь в `config.py`

2. Настройте области подсчета в `config.py`:
   - `AREA_1` - координаты первой области
   - `AREA_2` - координаты второй области

3. Запустите программу:
```bash
python main.py
```

4. Нажмите ESC для выхода

## Структура проекта

```
people_counter/
├── main.py              # Главный файл запуска
├── config.py            # Конфигурационные параметры
├── device_manager.py    # Управление устройством (CUDA/CPU)
├── model_loader.py      # Загрузка YOLO модели
├── detector.py          # Детекция объектов
├── tracker.py           # Трекинг объектов
├── counter.py           # Подсчет людей
├── visualizer.py        # Визуализация результатов
├── fps_calculator.py    # Расчет FPS
├── utils.py             # Вспомогательные функции
└── README.md            # Документация
```

## Модули

- **config.py** - Все конфигурационные параметры проекта
- **device_manager.py** - Определение и настройка устройства (CUDA/CPU)
- **model_loader.py** - Загрузка и инициализация YOLO модели
- **detector.py** - Детекция людей на кадре
- **tracker.py** - Отслеживание объектов между кадрами
- **counter.py** - Логика подсчета входящих/выходящих людей
- **visualizer.py** - Отрисовка результатов на кадре
- **fps_calculator.py** - Расчет и усреднение FPS
- **utils.py** - Вспомогательные функции

## Настройка

Основные параметры настраиваются в файле `config.py`:

- `MODEL_PATH` - путь к модели YOLO
- `VIDEO_PATH` - путь к видео файлу
- `AREA_1`, `AREA_2` - координаты зон подсчета
- `CONFIDENCE_THRESHOLD` - порог уверенности детекции
- `FRAME_WIDTH`, `FRAME_HEIGHT` - размер кадра

## Поддержка CUDA

Программа автоматически определяет доступность CUDA и использует GPU для ускорения обработки. Если CUDA недоступна, используется CPU.

Для установки PyTorch с поддержкой CUDA:
```bash
pip install torch torchvision --index-url https://download.pytorch.org/whl/cu118
```

## Лицензия

MIT License

## Автор

Ваше имя

## Благодарности

- Ultralytics за YOLOv8
- OpenCV за библиотеку компьютерного зрения

